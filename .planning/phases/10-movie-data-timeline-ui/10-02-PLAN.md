---
phase: 10-movie-data-timeline-ui
plan: 02
type: execute
wave: 2
depends_on: ["10-01"]
files_modified:
  - src/app/(app)/movie/page.tsx
  - src/app/(app)/movie/[id]/page.tsx
  - src/components/movie/movie-list.tsx
  - src/components/movie/create-movie-dialog.tsx
  - src/components/movie/movie-editor.tsx
autonomous: true

must_haves:
  truths:
    - "User can navigate to /movie from the sidebar and see a list of their movies"
    - "User can click 'Create Movie' to open a dialog, enter a name, and create a new movie"
    - "User can click a movie card to navigate to /movie/[id] editor page"
    - "Movie editor page loads movie data and displays movie name, scene count, and total duration"
    - "Empty movie editor shows a prompt to add scenes"
  artifacts:
    - path: "src/app/(app)/movie/page.tsx"
      provides: "Movie list route page"
      min_lines: 8
    - path: "src/app/(app)/movie/[id]/page.tsx"
      provides: "Movie editor route page"
      min_lines: 8
    - path: "src/components/movie/movie-list.tsx"
      provides: "Movie grid with cards, loading, empty states"
      min_lines: 50
    - path: "src/components/movie/create-movie-dialog.tsx"
      provides: "Dialog to create new movie with name input"
      min_lines: 40
    - path: "src/components/movie/movie-editor.tsx"
      provides: "Movie editor shell with header info and placeholder for timeline"
      min_lines: 40
  key_links:
    - from: "src/components/movie/movie-list.tsx"
      to: "convex/movies.ts"
      via: "useQuery for movie list"
      pattern: "useQuery\\(api\\.movies\\.list\\)"
    - from: "src/components/movie/create-movie-dialog.tsx"
      to: "convex/movies.ts"
      via: "useMutation for movie creation"
      pattern: "useMutation\\(api\\.movies\\.create\\)"
    - from: "src/components/movie/movie-editor.tsx"
      to: "convex/movies.ts"
      via: "useQuery for getWithClips"
      pattern: "useQuery\\(api\\.movies\\.getWithClips"
    - from: "src/components/movie/movie-list.tsx"
      to: "src/app/(app)/movie/[id]/page.tsx"
      via: "router.push to movie editor"
      pattern: "router\\.push\\(`/movie/"
---

<objective>
Create the movie list page, movie creation dialog, and movie editor shell with Convex query wiring.

Purpose: Give users the ability to create movies from the /movie page, see their movies listed, and navigate into a movie editor page that loads movie data. The editor shell provides the container where the timeline (Plan 03) will render.
Output: Two Next.js routes (/movie and /movie/[id]) and three React components (movie-list, create-movie-dialog, movie-editor).
</objective>

<execution_context>
@/Users/Kohelet/.claude/get-shit-done/workflows/execute-plan.md
@/Users/Kohelet/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/10-movie-data-timeline-ui/10-RESEARCH.md
@.planning/phases/10-movie-data-timeline-ui/10-01-SUMMARY.md
@src/app/(app)/library/page.tsx
@src/components/library/clip-library.tsx
@src/components/library/save-clip-dialog.tsx
@src/components/library/clip-card.tsx
@convex/movies.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create movie list page with grid, create dialog, and navigation</name>
  <files>
    src/app/(app)/movie/page.tsx
    src/components/movie/movie-list.tsx
    src/components/movie/create-movie-dialog.tsx
  </files>
  <action>
**1. Create `src/app/(app)/movie/page.tsx`:**

Follow the exact same layout pattern as `src/app/(app)/library/page.tsx`:
```tsx
import { MovieList } from "@/components/movie/movie-list";

export default function MoviePage() {
  return (
    <div className="flex-1 flex flex-col p-6">
      <div className="max-w-6xl mx-auto w-full space-y-6">
        <div>
          <h1 className="text-3xl font-bold">Movies</h1>
          <p className="text-muted-foreground mt-1">
            Your multi-scene movie projects
          </p>
        </div>
        <MovieList />
      </div>
    </div>
  );
}
```

**2. Create `src/components/movie/movie-list.tsx`:**

Follow the ClipLibrary component pattern (`src/components/library/clip-library.tsx`). This is a "use client" component.

- Use `useQuery(api.movies.list)` for reactive data
- Use `useMutation(api.movies.create)` wired through the create dialog
- Use `useRouter()` for navigation to `/movie/[id]`
- Import `{ api }` from `"../../../convex/_generated/api"` (same path pattern as clip-library.tsx)

**Three states:**

Loading state: Grid of 3 skeleton cards (aspect-video placeholder + text placeholders), matching clip-library's skeleton pattern.

Empty state: Centered icon (Film from lucide-react), "No movies yet" heading, "Create a movie to arrange your clips into scenes" description, "Create Movie" button that opens the create dialog.

Normal state: Grid with responsive columns (`grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4`). Each movie renders as a Card with:
- Top: Film icon in a colored bg-primary/10 area (since movies don't have thumbnails yet)
- Movie name (truncated)
- Scene count: "{N} scene{s}" text
- Total duration: "{(totalDurationInFrames / fps).toFixed(1)}s" (show "Empty" if 0 scenes)
- Click handler: `router.push(`/movie/${movie._id}`)`

Above the grid, render a "Create Movie" Button (Plus icon) that opens the CreateMovieDialog. After successful creation, navigate to the new movie's editor page: `router.push(`/movie/${newMovieId}`)`.

**3. Create `src/components/movie/create-movie-dialog.tsx`:**

Follow the SaveClipDialog pattern (`src/components/library/save-clip-dialog.tsx`). "use client" component.

Props: `{ open: boolean; onOpenChange: (open: boolean) => void; onCreated: (movieId: string) => void }`

- Dialog with DialogHeader title "Create Movie", description "Give your movie a name to get started."
- Input for movie name, autoFocus, placeholder "My Movie"
- Enter key triggers save
- Cancel and Create buttons
- On create: call `useMutation(api.movies.create)` with `{ name }`, toast.success("Movie created!"), call `onCreated(movieId)`, close dialog
- On error: toast.error with message
- Disable Create button while saving or if name is empty

Use the same Dialog, Input, Button component imports as save-clip-dialog.tsx.
  </action>
  <verify>Run `npm run build` to check for TypeScript/import errors. Navigate to http://localhost:3000/movie in browser -- page should render with empty state or movie list. Click "Create Movie" -- dialog should appear, create movie, and navigate to /movie/[id].</verify>
  <done>Movie list page at /movie shows user's movies in a grid with loading, empty, and populated states. Create Movie dialog creates a movie and navigates to its editor page. Clicking a movie card navigates to /movie/[id].</done>
</task>

<task type="auto">
  <name>Task 2: Create movie editor page and editor shell component</name>
  <files>
    src/app/(app)/movie/[id]/page.tsx
    src/components/movie/movie-editor.tsx
  </files>
  <action>
**1. Create `src/app/(app)/movie/[id]/page.tsx`:**

Follow the research example. Next.js App Router dynamic route with async params:
```tsx
import { MovieEditor } from "@/components/movie/movie-editor";

export default async function MovieEditorPage({
  params,
}: {
  params: Promise<{ id: string }>;
}) {
  const { id } = await params;
  return <MovieEditor movieId={id} />;
}
```

**2. Create `src/components/movie/movie-editor.tsx`:**

"use client" component. Props: `{ movieId: string }`.

**Data loading:**
- Use `useQuery(api.movies.getWithClips, { id: movieId as any })` to load movie with populated clips.
  Use the Convex Id cast pattern: `movieId as any` since the route param is a string but Convex expects Id<"movies">. This matches the clips.get pattern used on the create page.
- Handle three states: loading (skeleton), not found (error message with link back to /movie), loaded.

**Layout structure (when loaded):**

```
<div className="flex-1 flex flex-col h-full">
  {/* Header */}
  <div className="border-b px-6 py-4 flex items-center justify-between">
    <div>
      <h1 className="text-2xl font-bold">{movie.name}</h1>
      <p className="text-sm text-muted-foreground">
        {movie.scenes.length} scene{movie.scenes.length !== 1 ? "s" : ""} Â·
        {movie.totalDurationInFrames > 0
          ? `${(movie.totalDurationInFrames / movie.fps).toFixed(1)}s`
          : "Empty"}
      </p>
    </div>
    <div className="flex items-center gap-2">
      {/* Placeholder for future preview/render buttons (Phase 11) */}
    </div>
  </div>

  {/* Timeline area - placeholder for Plan 03 */}
  <div className="flex-1 flex flex-col">
    {movie.scenes.length === 0 ? (
      <div className="flex-1 flex items-center justify-center text-center">
        <div>
          <Film className="h-12 w-12 text-muted-foreground mx-auto mb-4" />
          <h2 className="text-lg font-semibold mb-1">No scenes yet</h2>
          <p className="text-sm text-muted-foreground mb-4">
            Add clips from your library to build your movie
          </p>
          {/* Add Scene button - will be wired in Plan 03 */}
        </div>
      </div>
    ) : (
      <div className="p-6">
        {/* Timeline component will be rendered here in Plan 03 */}
        <p className="text-muted-foreground text-sm">
          Timeline: {movie.scenes.length} scenes loaded
        </p>
      </div>
    )}
  </div>
</div>
```

Import Film from lucide-react. Import useQuery from "convex/react" and api from the generated path.

The editor shell intentionally leaves placeholder areas for the timeline and add-scene panel that Plan 03 will fill in. The key goal is that movie data loads reactively and the shell renders correctly.
  </action>
  <verify>Run `npm run build` to check for TypeScript/import errors. Navigate to http://localhost:3000/movie/[id] (using a real movie ID from the list page) -- should show movie name, scene count, duration, and empty state message. Navigating to a non-existent ID should show the not-found state.</verify>
  <done>Movie editor page at /movie/[id] loads movie data via getWithClips, displays movie name/stats in header, shows empty state for movies with no scenes, and has placeholder areas for the timeline component.</done>
</task>

</tasks>

<verification>
- `npm run build` passes with no TypeScript errors
- /movie page renders the movie list (empty state initially, then with cards after creating movies)
- Create Movie dialog creates a movie and redirects to /movie/[id]
- /movie/[id] loads the movie data and shows the editor shell with correct name, scene count, and duration
- Sidebar "Movie" link correctly navigates to /movie and shows active state
</verification>

<success_criteria>
- Both /movie and /movie/[id] routes work within the (app) layout with sidebar
- Movies can be created via dialog and appear in the list
- Movie editor shell loads movie data reactively and shows correct stats
- All components follow established patterns (ClipLibrary, SaveClipDialog, library page)
</success_criteria>

<output>
After completion, create `.planning/phases/10-movie-data-timeline-ui/10-02-SUMMARY.md`
</output>
