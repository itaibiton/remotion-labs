---
phase: 02-generation-pipeline
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/generation/prompt-input.tsx
  - src/components/generation/generation-status.tsx
  - src/components/generation/error-display.tsx
  - src/components/ui/textarea.tsx
autonomous: true

must_haves:
  truths:
    - "User can enter text in prompt textarea"
    - "Character count shows with warning near limit"
    - "Example prompts are clickable and fill textarea"
    - "Progress steps display during generation"
    - "Error messages show with retry option"
  artifacts:
    - path: "src/components/generation/prompt-input.tsx"
      provides: "Prompt input UI with examples"
      min_lines: 60
    - path: "src/components/generation/generation-status.tsx"
      provides: "Generation progress steps"
      min_lines: 30
    - path: "src/components/generation/error-display.tsx"
      provides: "Error display with retry"
      min_lines: 30
    - path: "src/components/ui/textarea.tsx"
      provides: "shadcn textarea component"
  key_links:
    - from: "src/components/generation/prompt-input.tsx"
      to: "onSubmit callback"
      via: "prop function"
      pattern: "onSubmit.*prompt"
    - from: "src/components/generation/error-display.tsx"
      to: "onRetry callback"
      via: "prop function"
      pattern: "onRetry"
---

<objective>
Create the UI components for the generation pipeline: prompt input with examples, progress status, and error handling.

Purpose: These components handle the user-facing generation experience. They need to work independently so they can be tested in isolation before integration.

Output: Three React components ready to be composed in the create page. Components use shadcn/ui styling and accept callbacks for generation logic.
</objective>

<execution_context>
@/Users/Kohelet/.claude/get-shit-done/workflows/execute-plan.md
@/Users/Kohelet/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-generation-pipeline/02-RESEARCH.md
@.planning/phases/02-generation-pipeline/02-CONTEXT.md
@src/components/ui/button.tsx
@src/lib/utils.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add shadcn textarea component</name>
  <files>
    src/components/ui/textarea.tsx
  </files>
  <action>
Add the shadcn/ui textarea component:

Run: `npx shadcn@latest add textarea`

This will create src/components/ui/textarea.tsx with the standard shadcn textarea styling.

If the command fails or is not available, create the component manually following shadcn patterns:
- "use client" directive
- forwardRef component wrapping native textarea
- cn() for className merging
- Standard shadcn styling: border, rounded, focus ring, disabled states
  </action>
  <verify>
File exists at src/components/ui/textarea.tsx. Can import and use in another component without errors.
  </verify>
  <done>
Textarea component available for use in prompt input.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create prompt input component</name>
  <files>
    src/components/generation/prompt-input.tsx
  </files>
  <action>
Create src/components/generation/prompt-input.tsx:

1. "use client" directive

2. Import: useState, useCallback from react, Button from @/components/ui/button, Textarea from @/components/ui/textarea

3. Constants:
   - EXAMPLE_PROMPTS array with 3-4 text animation examples:
     - "Animated title that says 'Welcome' with a fade-in effect"
     - "Kinetic typography: 'Think Different' with bold letters scaling in"
     - "Typewriter text revealing 'Hello World' character by character"
     - "Slide up text animation for 'Coming Soon' announcement"
   - MAX_CHARS = 2000
   - WARN_CHARS = 1500

4. Interface PromptInputProps:
   - onSubmit: (prompt: string) => Promise<void>
   - isGenerating: boolean
   - disabled?: boolean

5. Component logic:
   - State: prompt (string)
   - Computed: charCount, isOverLimit (>MAX_CHARS), isNearLimit (>WARN_CHARS)
   - handleSubmit: validate not empty, not over limit, not generating, then call onSubmit
   - handleExampleClick: setPrompt with example text

6. JSX structure (centered, max-w-2xl):
   - Textarea with:
     - value/onChange bound to prompt state
     - placeholder "Describe the animation you want to create..."
     - min-h-[120px], resize-none
     - disabled when isGenerating or disabled prop
   - Character count display (bottom-right of textarea):
     - Red when isOverLimit
     - Yellow when isNearLimit
     - Gray otherwise
     - Format: "charCount/MAX_CHARS"
   - Example prompts section:
     - "Try:" label
     - Clickable buttons/links for each example (show first ~35 chars + "...")
     - Disabled when generating
   - Submit button:
     - "Generate Animation" text (or "Generating..." when isGenerating)
     - Disabled when: empty prompt, over limit, generating, or disabled prop
     - Full width, shadcn Button default variant

Create src/components/generation/ directory if it doesn't exist.
  </action>
  <verify>
Component renders without errors. Typing in textarea updates character count. Example clicks fill textarea. Button disables appropriately.
  </verify>
  <done>
Prompt input component complete with character limit, examples, and submit handling.
  </done>
</task>

<task type="auto">
  <name>Task 3: Create generation status and error components</name>
  <files>
    src/components/generation/generation-status.tsx
    src/components/generation/error-display.tsx
  </files>
  <action>
Create src/components/generation/generation-status.tsx:

1. "use client" directive

2. Import lucide-react icons: Loader2, CheckCircle2, Circle

3. Define steps array:
   - { id: "analyzing", label: "Analyzing prompt..." }
   - { id: "generating", label: "Generating animation..." }
   - { id: "validating", label: "Validating code..." }

4. Interface GenerationStatusProps:
   - currentStep: string (matches step.id)

5. Component renders vertical list of steps:
   - Each step shows icon + label
   - Complete steps: CheckCircle2 (green)
   - Active step: Loader2 with animate-spin
   - Pending steps: Circle (gray)
   - Active step text is font-medium
   - Add estimated time text below: "Usually takes ~10-30 seconds"

---

Create src/components/generation/error-display.tsx:

1. "use client" directive

2. Import: AlertCircle, RefreshCw from lucide-react, Button from @/components/ui/button

3. Interface ErrorDisplayProps:
   - message: string
   - onRetry: () => void
   - retryCount: number
   - maxRetries?: number (default 3)

4. Component logic:
   - Compute canRetry = retryCount < maxRetries

5. JSX structure (red-themed alert box):
   - AlertCircle icon + "Generation failed" heading
   - Error message text
   - If canRetry: Button with RefreshCw icon, "Try Again (N attempts remaining)"
   - If !canRetry: Text suggesting to simplify prompt or try different animation
   - Style: bg-red-50 border border-red-200 rounded-lg p-4
  </action>
  <verify>
Both components render without errors. GenerationStatus shows different states based on currentStep. ErrorDisplay shows retry button when allowed, suggestion when exhausted.
  </verify>
  <done>
Status and error components complete. Ready for integration with generation flow.
  </done>
</task>

</tasks>

<verification>
1. All components compile without TypeScript errors
2. `npm run dev` starts without errors
3. Components can be imported in create page (test import statement compiles)
4. shadcn textarea component exists and exports properly
</verification>

<success_criteria>
- src/components/generation/ directory contains three components
- PromptInput: textarea, char count, examples, submit button
- GenerationStatus: three-step progress indicator
- ErrorDisplay: error message with conditional retry
- All components are client components ("use client")
- All use shadcn/ui styling patterns
</success_criteria>

<output>
After completion, create `.planning/phases/02-generation-pipeline/02-02-SUMMARY.md`
</output>
